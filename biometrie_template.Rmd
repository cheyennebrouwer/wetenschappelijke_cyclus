---
title: "Biometrie onderzoek"
authors: "Cheyenne Brouwer (399308), Kasthury Inparajah (462193), Demi van 't Oever (415069), Willem DaniÃ«l Visser(458075)"
date: "`24-04-2023`"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

```{r setup, include=FALSE}
# DON'T TOUCH THIS
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)

```

## Inleiding

Naar aanleiding van een schoolopdracht van de module "De Wetenschapplijke Cyclus" genaamd "Workshop Biometrie" is er een onderzoek uitvoerd met twee biometrische aspecten en hun relatie geanalyseerd. Er is onderzoek gedaan naar de relatie tussen de sexe van de mens en de lengte/breedte ratio van de dominante hand van studenten.

De onderszoeksvraag is: "Is er bij de mens een sexe verschil in de lengte/breedte ratio van de hand?". Er wordt er vannuit gegaan dat er bij de mens een sexe verschil in de lengte/breedte ratio van de hand. De nulhypothese luidt dan: "Er is bij de mens een geen sexe verschil in de lengte/breedte ratio van de hand."

### Ontwerp van het experiment

Van 40 proefpersonen, gelijk verdeeld over mannen en vrouwen en willekeurig geselecteerd in en rond het schoolgebouw, zal de sexe gevraagd worden en vervolgens de handlengte en -breedte gemeten worden.

::: protocol
#### Protocol voor meting handlengte en handbreedte

##### Benodigdheden

1.  Milimeter naukurige maatlat
2.  Spreadsheet om resultaten vast te leggen, met toegang hiertoe op locaties zonder internet-toegang.
3.  Een laborant-ID: een unieke *identifier* per metende onderzoeker
4.  Minstens twee metende onderzoekers

##### Data verzamelen

Er worden 40 studenten idividueel of in groepjes opgezocht met evenveel mannen, als vrouwen. De studenten worden per persoon gevraagd of zij mee willen doen met een klein onderzoek naar het verschil tussen sexe in de lengte/breedte ratio van de hand. Als deze instemmen wordt er gevraagd of deze hun hand naar de metende onderzoekers willen uitsteken en wordt gevraagd naar hun sexe.

###### Voor het meten van de handlengte

Een metende onderzoeker legt het maatlat op de handen van de studenten met de nulkant op het randje van de middelvinger of het bovenste handstreepje. De andere kant van de maatlat gaat dan richting de andere kant; op het randje van de middelvinger of de bovenste handspreepje. Dan lezen de metende onderzoekers beide de afstand tussen het randje van de middelvinger tot het bovenste handstreepje af en melden dit aan de noterende onderzoekers.

###### Voor het meten van de handbreedte

Een metende onderzoeker legt het maatlat opnieuw op de handen van de studenten met de nulkant op de onderste duimknokkel en de andere kant in de parallelle richting van het bovenste handstreepje. De metende onderzoekers lezen beide de afstand tussen de onderste duimknoppel en andere kant van de hand en melden dit aan de noterende onderzoekers.
:::

## Analyse

### Lees je eigen data in

Om data vanuit een tekstbestand in te lezen kan je dit codeblok gebruiken, aannemend dat je data er exact zo uitzien als in bovenstaande voorbeeld:

```{r demo-data-inlees}
data_file <- "./Biometrie_3.csv"

#data format: laborant_ID,subject_ID,handlengte,handbreedte,sexe
biometric_data <- read.table(file = data_file,
                        header = TRUE,
                        sep = ",")
print(biometric_data)
sort(biometric_data$sexe)
biometric_data$laborant_id <- as.factor(biometric_data$laborant_id)
biometric_data$ratio <- biometric_data$handlengte / biometric_data$handbreedte
head(biometric_data)

library(plyr)
mu_handlengte <- ddply(
  biometric_data, 
  "sexe", 
  summarise,
  grp.mean=mean(handlengte))
head(mu_handlengte)

library(plyr)
mu_handbreedte <- ddply(
  biometric_data, 
  "sexe", 
  summarise,
  grp.mean=mean(handbreedte))
head(mu_handbreedte)

library(plyr)
mu_ratio <- ddply(
  biometric_data, 
  "sexe", 
  summarise,
  grp.mean=mean(ratio))
head(mu_ratio)
```

Let op: als je missende data hebt moet je die specificeren door dit argument toe te voegen: `na.strings = "<jouw NA symbool>"`

### Beschrijvende statistiek

Onder het kopje data zijn al enkele statistische waardes terug te vinden. In totaal is er bij 40 proefpersonen zowel de handbreedte als handlengte gemeten. Tevens is er naar het geslacht (sexe) gevraagd. Aan het onderzoek hebben 19 vrouwen (F) deelgenomen en 21 mannen (M). De handbreedte van mannen is gemiddeld 107.8mm, waar deze bij vrouwen 96.1mm is. De gemiddelde handlengte bij mannen is 188.7mm, bij vrouwen is dit 174.4mm. De ratio is berekend door handlengte te delen door handbreedte. Bij mannen is de ratio 1.75, terwijl deze bij vrouwen 1.81 is.

LAAT ENKELE BESCHRIJVENDE STATISTISCHE WAARDES ZIEN. GEEF EEN OF MEERDERE BOXPLOTS EN HISTOGRAMMEN BESPREEK DEZE DATA EN FIGUREN KORT. KAN JE IETS ZEGGEN OVER DE DATAVERDELING?

### Welke verdeling?

Hoe kleiner de steekproefgrootte (*sample size*) hoe lastiger het is de onderliggende verdeling vast te stellen. Speel maar eens met dit blokje code, en verander de steekproefgrootte (`n=`) in de `rnorm()` functie en de `breaks=` in de `hist()` functie. Neem voor *n* bijvoorbeeld achtereenvolgens 10, 100, 1000, 10000, 10000 en voor *breaks* 5, 10, 50. Wanneer zie je een echte normaalverdeling verschijnen?

```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(
  x = rnorm(
    n = c(5, 10)
  )
)
ggplot(
  data = hist_data,
  mapping = aes(
    x = x
  )
) + geom_histogram(
  bins=10, 
  fill = "gold", 
  colour = "black", 
  breaks=c(5, 10)
) + theme_minimal()
```

::: attention
**Dit *experiment* met de argumenten van `rnorm()` en `hist()` moet je opnemen in je eigen RMarkdown.**\
Beantwoord deze vragen:

1.  Wat gebeurt er met de vorm van de verdeling als `n` groter wordt?

    -\> Bij 10000 is de histogram parallel gelijk, splitsend bij x=0, ook is de histogram consistenter in de verdeling van de `n` waarden op de balken. Als ik `n` op 10 zet veranderd de verdeling elke keer.

2.  Wat gebeurt er met de spreiding van de data (x-as) als `n` groter wordt, en kan je dat verklaren?

    -\> De spreiding is consistenter iedere keer als de data word verdeelt tussen de balken, dit is omdat de willekeurig gegenereerde getallen met de `rnorm()` formule een kleinere kans hebben om een bepaalde x-waarde te domineren. Daarmee is de willekeurigheid verborgen door een patroon.

3.  Waarom is bij zelfde instellingen voor `n` en `breaks` de uitkomst toch verschillend?

    -\> Dit is omdat x-as evenredig verdeelt is en soms liggen twee getallen erg dicht bij elkaar en moeten daardoor de zelfde bar delen.

4.  Welke minimale `n` geeft het meeste kans om een echte normaalverdeling te zien?

    -\> n=10000, uit de voorbeeld waarden. En anders `oneindig`

5.  Wat voor bijzonders is er aan de hand met het `breaks` argument? Geeft de documentatie daar een verklaring voor?

    -\> Het overschrijft alle andere instellingen over de horizontale verdeling, de documentatie meld: "Overrides `binwidth`, `bins`, `center`, and `boundary`"
:::

```{r fig.asp=.6}
ggplot(
  data = biometric_data,
  mapping = aes(
    x = handlengte, 
    color=sexe,
    fill=sexe)
) + geom_vline(
      data=mu_handlengte,
      aes(
        xintercept=grp.mean, 
        color=sexe),
      linetype="dashed"
) + geom_histogram(
  bins = 10,
  alpha=0.3,
  position="identity"
) + theme_minimal()

ggplot(
  data = biometric_data,
  mapping = aes(
    x = handbreedte, 
    color=sexe,
    fill=sexe)
) + geom_vline(
      data=mu_handbreedte,
      aes(
        xintercept=grp.mean, 
        color=sexe),
      linetype="dashed"
) + geom_histogram(
  bins = 10,
  alpha=0.3,
  position="identity"
) + theme_minimal()

library(ggplot2)
ggplot(data = biometric_data,
       mapping = aes(x = sexe, y = handlengte, fill = sexe)) +
    geom_boxplot() +
    geom_point() +
    labs(x = "Sexe", y = "handlengte") +  
    theme_minimal() 

ggplot(data = biometric_data,
       mapping = aes(x = ratio, fill = sexe)) +
    geom_histogram(bins = 10, colour = "black") + 
    facet_wrap(. ~ sexe) +                       
    labs(x = "lengte/breedte ratio") +
    theme_minimal()


```

### Bronnen van variatie

ONDERZOEK BRONNEN VAN VARIATIE BESPREEK DIT KORT

```{r}


ggplot(
  data = biometric_data,
  mapping = aes(
    x = reorder(laborant_id, handlengte), 
    y = handlengte, 
    fill = laborant_id)
) +
geom_boxplot() +
geom_point() +
scale_fill_manual(values=c("#d45eff", "#56B4E9", "#ffec5e", "#7bfc02"))+
labs(
  x = "Laborant id", 
  y = "Handlengte",
  title="Verschillen in handlengte tussen laboranten"
) +  
guides(fill=guide_legend(title="Laborant id")) +
theme_minimal()

ggplot(
    data = biometric_data,
    mapping = aes(
      x = reorder(laborant_id, handbreedte), 
      y = handbreedte, 
      fill = laborant_id
    )
) +
geom_boxplot() +
geom_point() +
scale_fill_manual(values=c("#d45eff", "#56B4E9", "#ffec5e", "#7bfc02"))+
labs(
  x = "Laborant id", 
  y = "Handbreedte",
  title="Verschillen in handbreedte tussen laboranten"
) +  
guides(fill=guide_legend(title="Laborant id")) +
theme_minimal()


ggplot(
  data = biometric_data,
  mapping = aes(
    x = reorder(laborant_id, ratio), 
    y = ratio, 
    fill = laborant_id 
  )
) +
geom_boxplot() +
geom_point() +
scale_fill_manual(
  values=c("#d45eff", "#56B4E9", "#ffec5e", "#7bfc02"),
) +
labs(
  x = "Laborant id", 
  y = "Ratio",
  title="Verschillen in ratios tussen laboranten"
) +  
guides(fill=guide_legend(title="Laborant id")) + 
theme_minimal()
```

### De hypothese aannemen?

VOER RELEVANTE STATISTISCHE TESTS UIT

## Reflectie op het experiment

::: info
Bespreek in je groep de volgende vragen en voeg de antwoorden toe aan je uitgewerkte onderzoeksdocument.

1.  Zijn de metingen tussen de verschillende meters ook (significant) verschillend? Zo ja, waardoor zou je de verschillen kunnen verklaren?

2.  Onderzoek de verschillen tussen mannen en vrouwen met betrekking tot hand lengte, handbreedte en de ratio.

3.  Zou je het protocol aanpassen na deze ervaring, of was hij voldoende duidelijk en reproduceerbaar?
:::

::: attention
#### Wat je moet inleveren

Voor de verwerking en analyse van je eigen data maak je gebruik van het aangeleverde template RMarkdown document. Daarin doorloop je dezelfde onderzoek stappen als hieronder, maar dan met je eigen data. Aan het einde van de dag gaat dat document, in originele en "geknitte" vorm, samen met je databestand, in een git repo die is opgezet volgens voorschift in de cursushandleiding. De link hiernaar toe gaat in je portfolio op eJournal. Let op dat je *alle* stappen hebt doorlopen voordat je inlevert. Gebruik ook de RStudio spellingscontrole!\
Vergeet niet jullie namen en studentnummers bovenaan de markdown te zetten!
:::
